<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <base href="/">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/css/alertify.min.css"/>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <meta name="google-signin-client_id" content="18229040173-c8cnia2v4jseslvf2j3j7m6vj8v2vbvk.apps.googleusercontent.com">

  </head>
  <body class="yellow">
  
    <a class="btn  red m-open" m-open="one"></a>
   
    <a class="btn-floating btn-large  blue m-open" m-open="two"></a>
   
    <a class="btn  green m-open" m-open="three"></a>
    
    <div class='font-title'>
      <p class="small">Hey you,</p>
      <div class='title-big'>Bored?</div>
      <p class="small" style="padding-top: 10px;">Go random!</p>
      <div class="g-signin2" style="display: inline-flex;" data-width="40" data-height="40" data-longtitle="true" data-onsuccess="onSignIn"></div>
      <button id="logbtn" style="display: inline-flex;" class="waves-effect waves-light btn" type="button" onclick="signOut()">Log Out</button>
    </div>

    <!-- structure -->
    <div class="m-modal" m-modal="one">
      <div class="m-close">X</div>
      <div class="m-body">
          <div class="anime-box">
            <div class="anime-text">
              <span id="text"></span>
            </div>
            <div class="anime-director">
              - <span id="director"></span>
            </div>
            <div class="anime-desc">
              <span id="desc"></span>
            </div>
            <div class="buttons" id="star">
              <a class="button">
                <i class="fa fa-star" style="color: tomato"></i>
              </a>
              <span style="font-size: 1.3em"></span>
              <button class="button" id="new-anime">New Anime</button>
            </div>
          </div>
        <div id="movie"></div>
      </div>
    </div>
   
    <div class="m-modal" m-modal="two">
      <div class="m-close">X</div>
      <div class="m-body">
        <div id="activity"></div>
        <form class="searchbox" method="get" action="https://www.google.com/search">
        <input type="text" name="q" size="31" value="">
        </form>
      </div>
    </div>
   
    <div class="m-modal" m-modal="three">
      <div class="m-close">X</div>
      <div class="m-body">Three</div>
    </div>

    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/alertify.min.js"></script>
    <script src="main.js"></script>
    <script src="login.js"></script>
    <script>

      let animeTitle, animeDesc, animeDir, animeStar
        function getAnim() {
        $.ajax({
          method: 'GET',
          url: 'http://localhost:3000/anim'
        })
          .done(film => {
            console.log(film)
            animeTitle = film.data.title
            animeDesc = film.data.description
            animeDir = film.data.director
            animeStar = film.data.rt_score

            console.log(animeTitle)
            console.log(animeDesc)
            console.log(animeDir)
            console.log(animeStar)
            $(".anime-text").animate({
              opacity: 0
            }, 500,
            function() {
              $(this).animate({
                opacity: 1
              }, 500);
              $('#text').text(animeTitle);
            });
            $(".anime-desc").animate({
              opacity: 0
            }, 500,
            function() {
              $(this).animate({
                opacity: 1
              }, 500);
              $('#desc').text(animeDesc);
            });
            $(".buttons").animate({
              opacity: 0
            }, 500,
            function() {
              $(this).animate({
                opacity: 1
              }, 500);
              $('#star span').empty().append(animeStar);
            });

            $(".anime-director").animate({
              opacity: 0
            }, 500,
            function() {
              $(this).animate({
                opacity: 1
              }, 500);
              $('#director').html(animeDir);
            })
          })
          .fail(err => {
            console.log(err);
          })
          
        }

      $(document).ready( function() {
        $(".m-open").modalF()

        getAnim()
        $('#new-anime').on('click', getAnim);
        
        $.ajax({
          type: "get",
          url: "http://localhost:3000/activity",
        })
        .done((activity)=>{
          $('#activity').empty()
          $('#activity').append(`
          <p>${activity.activity}</p>
          <p>${activity.type}</p>`)
          console.log(activity)
        })
        .fail((err)=>{err})
      })
    </script>
  </body>
</html>